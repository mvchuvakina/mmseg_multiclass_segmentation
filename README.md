# Проект по обучению модели для мультиклассовой семантической сегментации

## Описание

В данном проекте была реализована задача мультиклассовой семантической сегментации с использованием библиотеки **mmsegmentation**. Модель должна была быть обучена на предоставленном датасете, с целью достижения метрики **mDice > 0.75** на тестовом наборе данных. Для этого были проведены несколько экспериментов, включая обучение моделей **DeepLabV3+** и **U-Net**, а также анализ данных с помощью методов **EDA**.

## Этапы работы

1. **Исследовательский анализ данных (EDA)**: Мы провели анализ данных, изучив распределение классов, качество масок и изображения. Было выявлено, что существует сильный дисбаланс классов, где фон занимает около 91% всех пикселей.

2. **Конвертация данных**: Данные в формате **mmsegmentation** были конвертированы в формат **COCO** для удобства доразметки в **CVAT**. После доразметки они были возвращены в формат **mmsegmentation**.

3. **Обучение моделей**:
    - **DeepLabV3+** с архитектурой на основе **ResNet-50**.
    - **U-Net** с **Batch Normalization** и **Dropout**.

4. **Анализ результатов**: После тренировки моделей были проанализированы их результаты с помощью метрик **mDice** и **IoU**. Также были сохранены лучшие и худшие примеры предсказаний для дальнейшего улучшения модели.

## Проблемы и ограничения

К сожалению, не удалось выполнить полный цикл обучения и анализа из-за ограничений, связанных с доступом к виртуальной машине (ВМ) для вычислений и недостаточными ресурсами на локальном компьютере. 

### Проблемы с доступом к ВМ:
- В процессе работы над проектом возникли сложности с получением доступа к **виртуальной машине (ВМ)** для выполнения вычислений с использованием **GPU**.
- На **локальном компьютере** был использован только **ЦП**, что привело к значительным задержкам в процессе обучения моделей, особенно для таких больших архитектур, как **DeepLabV3+** и **U-Net**.
- Из-за ограничений в мощности процессора локального компьютера обучение не удалось завершить в требуемые сроки.

### Конфликты версий:
- Кроме того, возникли **конфликты версий** между библиотеками, что привело к проблемам при установке и запуске некоторых зависимостей, таких как **mmsegmentation**, **torch** и **torchvision**.
- В частности, несовместимость версий **torch** и **torchvision** с определёнными версиями **CUDA** вызвала ошибки при попытке обучения на GPU.
- На локальном компьютере были использованы версии библиотек, которые не полностью совместимы с требуемыми для работы модели.


## Структура проекта

```
/
├── src/
│ ├── data/
│ ├── analysis/
│ ├── experiments/
│ └── utils/
├── supplementary/
│ └── viz/
├── configs/
│ ├── config_experiment_1.py
│ └── config_experiment_2.py
└── requirements.txt
```

